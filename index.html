<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Memories - D</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #0a0a14;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(255, 118, 117, 0.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(155, 89, 182, 0.05) 0%, transparent 20%);
      color: #e8e6e3;
      font-family: 'Georgia', 'Times New Roman', serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    /* Efek kertas tua */
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.03' fill-rule='evenodd'/%3E%3C/svg%3E");
      opacity: 0.4;
      z-index: -2;
    }

    .shooting-star {
      position: absolute;
      width: 2px;
      height: 100px;
      background: linear-gradient(to bottom, transparent, #fff, transparent);
      border-radius: 50%;
      top: -100px;
      box-shadow:
        0 0 15px #fff,
        0 0 30px #a29bfe;
      animation: shoot 3s ease-in-out forwards;
      opacity: 0;
      z-index: 1;
    }

    @keyframes shoot {
      0% { transform: translateY(0) rotate(15deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(100vh) rotate(15deg); opacity: 0; }
    }

    .stars {
      position: fixed;
      width: 100%;
      height: 100%;
      background: transparent;
      z-index: -1;
      overflow: hidden;
    }

    .star {
      position: absolute;
      width: 1px;
      height: 1px;
      background: white;
      border-radius: 50%;
      box-shadow:
       0 0 3px #a29bfe,
       0 0 6px #81ecec;
      animation: blink 6s infinite ease-in-out alternate;
    }

    @keyframes blink {
      0%, 100% { opacity: 0.1; }
      50% { opacity: 0.8; }
    }

    /* Container utama seperti buku/surat */
    .container {
      width: 90%;
      max-width: 900px;
      padding: 50px 60px;
      border-radius: 4px;
      background: linear-gradient(135deg, #1a1a2a 0%, #16213e 100%);
      position: relative;
      text-align: center;
      z-index: 10;
      box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 0 1px rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 118, 117, 0.2);
      margin: 30px 0;
    }

    /* Efek halaman buku */
    .container::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, #ff7675, transparent);
    }

    .container::after {
      content: "";
      position: absolute;
      top: 10px;
      left: 10px;
      right: 10px;
      bottom: 10px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      pointer-events: none;
      border-radius: 2px;
    }

    h1 {
      color: #ff7675;
      margin-bottom: 30px;
      font-size: 3em;
      font-weight: 300;
      letter-spacing: 3px;
      text-shadow: 0 2px 10px rgba(255, 118, 117, 0.3);
      position: relative;
      padding-bottom: 15px;
    }

    h1::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 25%;
      width: 50%;
      height: 1px;
      background: linear-gradient(90deg, transparent, #ff7675, transparent);
    }

    /* Header dengan garis waktu */
    .letter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      padding: 15px 0;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-style: italic;
      color: #aaa;
      font-size: 0.9em;
    }

    /* Player musik yang lebih elegan */
    .media-player {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 20px;
      margin: 30px 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }

    .media-player p {
      margin: 0 0 15px 0;
      color: #ccc;
      font-size: 1.1em;
    }

    .progress-container {
      width: 100%;
      height: 6px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
      cursor: pointer;
      margin: 15px 0;
      position: relative;
      overflow: hidden;
    }

    .progress {
      height: 100%;
      background: linear-gradient(90deg, #ff7675, #fd79a8);
      width: 0%;
      border-radius: 3px;
      position: relative;
    }

    .progress::after {
      content: "";
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 12px;
      height: 12px;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 0 10px #ff7675;
    }

    /* Input password dengan style surat */
    .password-section {
      margin: 40px 0;
      padding: 30px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      border-left: 4px solid #ff7675;
    }

    .password-section p {
      margin-bottom: 20px;
      color: #ccc;
      font-size: 1.2em;
      font-style: italic;
    }

    input[type="password"] {
      padding: 15px 20px;
      width: 250px;
      margin: 15px 0;
      border: 1px solid rgba(255, 118, 117, 0.3);
      border-radius: 8px;
      background-color: rgba(255, 255, 255, 0.05);
      color: #fff;
      font-size: 18px;
      font-family: 'Georgia', serif;
      text-align: center;
      transition: all 0.3s ease;
      letter-spacing: 2px;
    }

    input[type="password"]:focus {
      outline: none;
      border-color: #ff7675;
      box-shadow: 0 0 20px rgba(255, 118, 117, 0.2);
      background-color: rgba(255, 255, 255, 0.08);
    }

    /* Tombol dengan style vintage */
    button {
      padding: 15px 35px;
      background: linear-gradient(135deg, #ff7675 0%, #fd79a8 100%);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 1.1em;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 10px;
      font-family: 'Georgia', serif;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
    }

    button::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }

    button:hover::before {
      left: 100%;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(255, 118, 117, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    /* Navigasi halaman */
    .navigasi {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 40px;
      padding-top: 30px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      flex-wrap: wrap;
    }

    /* Konten surat */
    .layer {
      display: none;
      animation: fadeIn 0.8s ease-out forwards;
      text-align: left;
      line-height: 1.8;
      font-size: 1.15em;
    }

    .layer.active {
      display: block;
    }

    .hidden {
      display: none;
    }

    /* Dashboard surat */
    .dashboard-text {
      text-align: center;
      padding: 40px 20px;
      margin: 20px 0;
    }

    .dashboard-text pre {
      font-size: 1.2em;
      line-height: 1.6;
      color: #ccc;
      white-space: pre-wrap;
      font-family: 'Courier New', monospace;
      text-align: center;
    }

    /* Indikator halaman */
    .page-indicator {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: #ff7675;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.9em;
      z-index: 100;
      border: 1px solid rgba(255, 118, 117, 0.3);
      backdrop-filter: blur(10px);
    }

    /* Efek tulisan mengetik */
    .typewriter {
      overflow: hidden;
      border-right: 2px solid #ff7675;
      white-space: nowrap;
      margin: 0 auto;
      animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
    }

    @keyframes typing {
      from { width: 0 }
      to { width: 100% }
    }

    @keyframes blink-caret {
      from, to { border-color: transparent }
      50% { border-color: #ff7675 }
    }

    /* Surat content */
    .letter-content {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      padding: 40px;
      margin: 20px 0;
      border-left: 3px solid #ff7675;
      position: relative;
      min-height: 400px;
    }

    .letter-content p {
      margin-bottom: 25px;
      text-indent: 40px;
    }

    /* Signature */
    .signature {
      text-align: right;
      margin-top: 60px;
      font-style: italic;
      color: #ff7675;
      font-size: 1.3em;
      padding-top: 20px;
      border-top: 1px dashed rgba(255, 118, 117, 0.3);
    }

    /* Galeri foto */
    .photo-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 15px;
      margin: 40px 0;
    }

    .photo-item {
      position: relative;
      overflow: hidden;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .photo-item:hover {
      transform: scale(1.03);
    }

    .photo-item img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      display: block;
    }

    /* Lightbox */
    .lightbox {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }

    .lightbox.active {
      opacity: 1;
      pointer-events: all;
    }

    .lightbox img {
      max-width: 90vw;
      max-height: 90vh;
      border-radius: 10px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 30px 20px;
        width: 95%;
      }
      
      h1 {
        font-size: 2em;
      }
      
      .letter-content {
        padding: 20px;
      }
      
      .photo-gallery {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }
    }

    /* Animasi fade in */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Efek wax seal */
    .wax-seal {
      position: absolute;
      bottom: -25px;
      right: 30px;
      width: 60px;
      height: 60px;
      background: radial-gradient(circle at 30% 30%, #ff7675, #d63031);
      border-radius: 50%;
      opacity: 0.8;
      transform: rotate(15deg);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .wax-seal::after {
      content: "D";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 24px;
      font-weight: bold;
      font-family: 'Georgia', serif;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚úâÔ∏è Surat Untukmu</h1>
    
    <div class="letter-header">
      <span>üìÖ 24 Juni 2025</span>
      <span>üïí 00:30</span>
      <span>üìç Dari: D</span>
    </div>

    <!-- üé∂ MUSIC PLAYER -->
    <div class="media-player">
      <p id="judulLagu">üéµ Memutar: Memories</p>
      <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
        <button onclick="prevSong()" style="padding: 10px; border-radius: 50%; width: 45px; height: 45px;">‚èÆ</button>
        <button onclick="togglePlay()" style="padding: 12px; border-radius: 50%; width: 55px; height: 55px;">‚ñ∂Ô∏è</button>
        <button onclick="nextSong()" style="padding: 10px; border-radius: 50%; width: 45px; height: 45px;">‚è≠</button>
      </div>
      <div class="progress-container" onclick="setProgress(event)">
        <div class="progress" id="progressBar"></div>
      </div>
      <div id="timeDisplay" class="time">0:00 / 0:00</div>
    </div>

    <!-- LOGIN SECTION -->
    <div id="loginSection" class="password-section">
      <p>"Setiap kata tersimpan rapi, menunggu orang yang tepat untuk membacanya."</p>
      <input type="password" id="password" placeholder="Masukkan kunci rahasia">
      <br>
      <button onclick="bukaSurat()">üîì Buka Surat</button>
      <p id="errorMsg" style="color:#ff7675; display:none; margin-top: 15px;">Kunci salah. Coba ingat-ingat lagi...</p>
    </div>

    <!-- SURAT SECTION -->
    <div id="suratSection" class="hidden">
      <div id="counter" style="text-align: center; margin: 20px 0; color: #aaa; font-style: italic;"></div>

      <!-- DASHBOARD SURAT -->
      <div class="layer active" id="dashboardSurat">
        <div class="dashboard-text">
          <div class="wax-seal"></div>
          <div style="font-size: 5em; margin: 20px 0;">üíå</div>
          <h2 style="color: #ff7675; margin-bottom: 20px;">Surat Pribadi Untukmu</h2>
          <div id="asciiNotifAnime" style="display:none;"></div>
        </div>
        <div class="navigasi">
          <button id="btnBukaSurat" onclick="bukaSuratAsli()" disabled>üìñ Baca Surat</button>
          <button id="btnNanti" onclick="window.location.href='https://google.com'" disabled>üòî Nanti Saja</button>
        </div>
      </div>

      <!-- SEMUA HALAMAN SURAT -->
      <div id="semuaHalaman"></div>
    </div>

    <div class="page-indicator" id="pageIndicator">Halaman 1</div>
  </div>

  <!-- LIGHTBOX -->
  <div id="lightbox" class="lightbox" onclick="this.classList.remove('active')">
    <img id="lightboxImg" src="" alt="Preview">
  </div>

  <!-- BACKGROUND STARS -->
  <div class="stars"></div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>
  // Konfigurasi tetap sama...
  const passwordHash = "f09b133c45f78e374cd650c77229de1a5ea54dc4d2d3ca9bb1ddfe3c496f7939";
  const encryptedSurat = {
      halaman1: "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",
      halaman2: "U2FsdGVkX18Lie0u+XH/MqDCl+9+vnRof/UI45uRfgNkGDmWsahSNOUdP/dmg6j4GbXfrSJjRt0YBYXN4dH/60gXaYYQOksCX8bm8zG5BhNgcSb9uAvZ0Vy/b5bBVHSjtZAkSVvKFukPHU5jORRMubK/3jYxvZ/MNLp7Zwy++ePlpmguVl0+eP6vkVdt5FyAXdlCM2gHCJe60J9hezkJ2enrOOU2vt3nWdmjEJO8juau5apV48ztnQBRQKkU/UgTY5s4uwmx9FECiHUIpRVAVDl+gf4Kg/533Ey/mEmRjhV2+DEYqDeIEXmnHOhvGz4m",
      halaman8: "U2FsdGVkX18yo6X6jc6RlePplOt/mZJfT19F5q234eJgG3LGIrmm1qWj6r1P0jxhcYbPNafLghnLdYWcMwQmJGTueZ19G5XeYfXC8DSL10B2HdNIrpTyHoORbPorbn2fOz3gOtiqjOPuS53m6c1Yz5dMhJqjHidpka4c/4vqMOtS2BkA8Kiw0OkLqy0Ya1/OHlEUWKE365rkW4D0+NriEMpWum3AxMEtVGjZzxIzNQMtJ4kDqHsdPw+cgrB/6z+Fj9fibPGFFW11V/D+e07GeZ5yEZVS2yu0thRV/ErLiw0laUU1rmcbIZzZv+g/AJ3NuX7gBBUoEGHkH7yhUbHASmx2llldkjlvWg6Dpwt9NhDiRrGlQYNgB01mVN/jIt+TE64T3kMy4lTi2rHEgsWaKBhyUIyWCUWpMNGmxHt/j/oGajLmC4Ao+4U/3PnC4gy5jgQsOSrD6e0O9eur8WUtskNNrJfgw4EENnrtFZfTqpf5Mb/ZXBUh79SG3FtakMNpJdpGfpiQeBMnxdNhImU7pgzZw6zlojdqZCuI/UWeqKlQYkXFCz6jIGd12+7AY75qyLXTse0P9yPElEh4ovRlU1ftSYyc6FC5qzkVH9bLNoh2TJMshBCzSOkyP2cSW1EP3bEebJ6J021J91hJ1LXjPZyt+yJoljnTpMM2JOH+NN5wxVBrZR95+3cGZwBUO6XxDPllhmUjkfpvx48EOksKt/1BrFqZ9gsiNXlgWhm5k+ym/svjWby04NgX4oW4A5CIitKeDSA7mt+3S1dgWZCOuUpyDY4rs6cKm/kzmy9Qs5Iv+cS9MnLqVu1bnEFZOGDq3xDSpJ+wEDWrtjw48KguZ6JVVXW2ozJDqxsjedZwDslgbRC0emdSkjsJqZTbfBN9aMwgfX6XttinGbn//VvGQbjQIAkM8B++1hi9902HD6w+cCI1U3IwCJVBbzi2D0ognDBNhJhCKaYf0dCPm2YUM5NqwzCGdF2srhULqrqc/fZVnE83kxAyeezRcQYXB+ZDBQLqPhAMeVcGj70BmuLNoUaOZYGtSNO1G0Fm/IB7RmByp1FojVtSOSmajuS3Vmqj54xq7GJeULkuggsU+idaMY+cqABFTt6GE/m2pVazd+MBPv+KS/o/FaLsyq2NboCy4VWf5YD87r5SAGemkyDWnrUgI+hBjb1SHi53zPHDjfgUgDaaLtKHjNhMLRZxY2GR09kRZBqVM9a1zWBAYZ2dyvOswpyzqu88SyYqH+TpUAxCxdG/LcwQwO7CpSrglw+KV4jT0ZBDrRKnJLTAFbvBBFrR4EFoxziball6Xrp7+q5Il9ZAZjuA8GmkxqlfxbPEipWQ7/9aHIc81+RFRHI1cTfDQ9ydJ4ziDS8y8ibVpJm1g0G6ZDntbjqr7TXlg+YFKc1cvriTESotvvDEzWRkN3VwoSRsUvuFK27kPVFARif5W8DgQYtlq0TFfK+8y0KPe88UooKHnJJsgBjPfJQ+ObboHuNRMAA/b1o12qhnSEBT4mh/cNG2i+ztbwvCYyk6orqMuMRYXWoKT/dRLLmab5kw8RxOnijXvEjZY9DbXTnuWl/AMU/nKM/i8pJrzfUXGiBCjMAqcRhubckB61eJBEuZhwaW6qzCjlEhIKrelmlCAIBv2jEcA/KiQjKN4M7Mz528eeoT8kVRmQhFiw750G0Du9tkmPeV7EchgI4FOPBJ4aaiu939OPQSgqy1DDCl",
      halaman9: "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",
      halaman10: "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",
      suratTerakhir: "U2FsdGVkX18kScDn3Q/XZxlN/bY2U8aSQQMakJxdoIgak05Ecknjubfw32RENGXLYgkIvws/ct07apmhsPzjYJwdaNakQIeYDuNFngTUWr15R6NemjBagOw2Bbe+tUA63/E5mKM8repofTsBeXd0UbE0QXg4bprGIDnfSszmOi/bdS03G1eAjaazDN8kRYd0dKBFtenYPp6PWI7jmlU0fdHXlxlQ+F/Y0ZFDw1h4/ZqrT6IziMf8egdQPTXsSHk95n0qitNvsM85C4fjQPkX4hP1vw9gtczzVjf1bJqc3bCQZ8nMxuhe0FSeJyZGrzNS/ea77Lw8xKfzE1sEpe9+PycbtdZ+P4eBn8f1KspDCYpp4Y1lU1e+5sDuRStBVbWbiB2Jetv7mdnVc5elapKaW8RASBHoW4bo4na8Bu2WJlLEtLMFkBBDmOlSU5RVDDo1nszon6LHFoD0AkHWPGRRJw==",
  };

  // Variabel musik
  const laguList = [
    { judul: "New x Ruin My Life (Slowed)", file: "X.mp3" },
    { judul: "Cardigan - Taylor Swift", file: "cardigan.mp3" },
    { judul: "Message in a Bottle - Taylor Swift", file: "message-in-a-bottle.mp3" },
    { judul: "All Too Well - Taylor Swift", file: "all-too-well.mp3" },
    { judul: "Your Are In Love - Taylor Swift", file: "your-are-in-love.mp3" },
    { judul: "Cry - Cigarettes After Sex", file: "cry.mp3" },   
    { judul: "Apocalypse - Cigarettes After Sex", file: "apocalypse.mp3" },   
  ];

  let index = 0;
  let player, judulLagu, progressBar, timeDisplay;

  document.addEventListener("DOMContentLoaded", () => {
    player = document.getElementById("player");
    judulLagu = document.getElementById("judulLagu");
    progressBar = document.getElementById("progressBar");
    timeDisplay = document.getElementById("timeDisplay");

    if (player) {
      player.addEventListener("timeupdate", updateProgress);
      player.addEventListener("loadedmetadata", updateProgress);
      player.addEventListener("ended", nextSong);
      loadLagu();
    }
  });

  function loadLagu() {
    if (!player || !laguList.length) return;
    player.src = laguList[index].file;
    judulLagu.textContent = "üéµ " + laguList[index].judul;
  }

  function togglePlay() {
    if (!player) return;
    if (player.paused) {
      player.play().catch(() => {});
      document.querySelector('button[onclick="togglePlay()"]').innerHTML = '‚è∏Ô∏è';
    } else {
      player.pause();
      document.querySelector('button[onclick="togglePlay()"]').innerHTML = '‚ñ∂Ô∏è';
    }
  }

  function nextSong() {
    if (!player) return;
    index = (index + 1) % laguList.length;
    loadLagu();
    player.play();
  }

  function prevSong() {
    if (!player) return;
    index = (index - 1 + laguList.length) % laguList.length;
    loadLagu();
    player.play();
  }

  function updateProgress() {
    if (!player || !progressBar || !timeDisplay) return;
    const current = player.currentTime;
    const duration = player.duration || 0;
    const percent = (current / duration) * 100;
    progressBar.style.width = percent + "%";

    const format = t => {
      const m = Math.floor(t / 60);
      const s = Math.floor(t % 60);
      return `${m}:${s < 10 ? "0" + s : s}`;
    };
    timeDisplay.textContent = `${format(current)} / ${format(duration)}`;
  }

  function setProgress(e) {
    if (!player) return;
    const rect = e.currentTarget.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const width = rect.width;
    const percent = clickX / width;
    player.currentTime = player.duration * percent;
  }

  function playMusik() {
    if (player) player.play().catch(() => {});
  }

  let passwordYangBenar = "";

  async function bukaSurat() {
    const pass = document.getElementById("password").value;
    const encoder = new TextEncoder();
    const data = encoder.encode(pass);
    const hashBuffer = await crypto.subtle.digest("SHA-256", data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join("");

    if (hashHex === passwordHash) {
      passwordYangBenar = pass;
      document.getElementById("loginSection").classList.add("hidden");
      document.getElementById("suratSection").classList.remove("hidden");
      playMusik();
      hitungHari();
      gantiHalaman("dashboardSurat");

      setTimeout(() => {
        showAsciiAnime();
        document.getElementById("btnBukaSurat").disabled = false;
        document.getElementById("btnNanti").disabled = false;
      }, 1000);

      renderHalaman(pass);

      // Load gallery
      if (typeof fetch !== 'undefined') {
        fetch("foto.json")
          .then(res => res.json())
          .then(encrypted => {
            window.preloadedGaleri = encrypted.map(e =>
              CryptoJS.AES.decrypt(e, pass).toString(CryptoJS.enc.Utf8)
            );
          });
      }
    } else {
      document.getElementById("errorMsg").style.display = "block";
    }
  }

  function showAsciiAnime() {
    const notif = document.getElementById("asciiNotifAnime");
    const asciiText = `
üìú Hi, seseorang yang selalu aku tunggu untuk baca surat ini...

Tolong dibaca sampai habis ya, karena surat ini kubuat penuh dengan kenangan hehe...
Kalau kamu cape baca, pelan-pelan saja per halaman, tidak usah terburu-buru.

üñ§ Surat ini diam-diam dijaga sejak hari pertama...
Dan hanya untuk kamu.

Dengan sayang,
- D
    `;

    notif.style.display = "block";
    notif.textContent = "";
    notif.style.fontFamily = "'Courier New', monospace";
    notif.style.lineHeight = "1.6";
    
    let i = 0;
    function typingAnime() {
      if (i < asciiText.length) {
        notif.textContent += asciiText.charAt(i);
        i++;
        setTimeout(typingAnime, 45);
      }
    }
    typingAnime();
  }

  function gantiHalaman(n) {
    document.querySelectorAll(".layer").forEach(el => el.classList.remove("active"));
    const target = typeof n === 'string' ? document.getElementById(n) : document.getElementById("halaman" + n);
    if (target) target.classList.add("active");
    
    // Update page indicator
    const pageIndicator = document.getElementById("pageIndicator");
    if (typeof n === 'number') {
      pageIndicator.textContent = `Halaman ${n}`;
    }
  }

  function bukaSuratAsli() {
    gantiHalaman(1);
  }

  function hitungHari() {
    const awal = new Date("2025-06-24T00:30:00");
    const sekarang = new Date();
    const selisih = Math.floor((sekarang - awal) / (1000 * 60 * 60 * 24));
    document.getElementById("counter").innerHTML = `
      <div style="background: rgba(255,118,117,0.1); padding: 15px; border-radius: 8px; border-left: 3px solid #ff7675;">
        üìÖ Surat ini telah disimpan selama <strong>${selisih} hari</strong>
        <br>
        <small style="color: #aaa;">Sejak 24 Juni 2025, 00:30</small>
      </div>
    `;
  }

  function renderHalaman(kunci) {
    const container = document.getElementById("semuaHalaman");
    for (let i = 1; i <= 50; i++) {
      const key = "halaman" + i;
      if (!encryptedSurat[key]) continue;

      const div = document.createElement("div");
      div.classList.add("layer");
      div.id = key;

      // Decrypt content
      const decrypted = CryptoJS.AES.decrypt(encryptedSurat[key], kunci).toString(CryptoJS.enc.Utf8);
      
      const letterContent = document.createElement("div");
      letterContent.className = "letter-content";
      
      const p = document.createElement("p");
      p.textContent = decrypted;
      p.style.whiteSpace = "pre-wrap";
      
      letterContent.appendChild(p);

      // Add signature for last paragraph
      if (i === 10) {
        const signature = document.createElement("div");
        signature.className = "signature";
        signature.innerHTML = "Dengan cinta,<br><strong>D</strong>";
        letterContent.appendChild(signature);
      }

      const timestamp = document.createElement("div");
      timestamp.className = "timestamper";
      timestamp.textContent = `üìÖ Dibuka pada ${new Date().toLocaleString("id-ID")}`;

      const nav = document.createElement("div");
      nav.className = "navigasi";

      if (i > 1) {
        const back = document.createElement("button");
        back.textContent = "‚¨Ö Kembali";
        back.onclick = () => gantiHalaman(i - 1);
        nav.appendChild(back);
      }

      if (i < 50 && encryptedSurat["halaman" + (i + 1)]) {
        const next = document.createElement("button");
        next.textContent = "Lanjut ‚û°";
        next.onclick = () => gantiHalaman(i + 1);
        nav.appendChild(next);
      } else {
        const toLast = document.createElement("button");
        toLast.textContent = "üìú Surat Terakhir";
        toLast.onclick = () => bukaSuratTerakhir(kunci);
        nav.appendChild(toLast);
      }

      div.appendChild(letterContent);
      div.appendChild(timestamp);
      div.appendChild(nav);
      container.appendChild(div);
    }
  }

  function bukaSuratTerakhir(kunci) {
    const container = document.getElementById("semuaHalaman");
    container.querySelectorAll(".layer").forEach(el => el.remove());

    const div = document.createElement("div");
    div.classList.add("layer", "active");
    div.id = "suratTerakhirLayer";

    // Decrypt last letter
    const decrypted = CryptoJS.AES.decrypt(encryptedSurat.suratTerakhir, kunci).toString(CryptoJS.enc.Utf8);
    
    const letterContent = document.createElement("div");
    letterContent.className = "letter-content";
    
    const p = document.createElement("p");
    p.textContent = decrypted;
    p.style.whiteSpace = "pre-wrap";
    
    letterContent.appendChild(p);

    const signature = document.createElement("div");
    signature.className = "signature";
    signature.innerHTML = "Terima kasih telah membaca.<br><strong>Selalu, D</strong>";
    letterContent.appendChild(signature);

    const notif = document.createElement("div");
    notif.className = "notif-penutup";
    notif.innerHTML = `
      <div style="text-align: center; padding: 30px; background: rgba(255,118,117,0.1); border-radius: 10px; margin: 20px 0;">
        <div style="font-size: 2em;">üíå</div>
        <h3 style="color: #ff7675;">Surat Telah Dibaca Sampai Akhir</h3>
        <p>Setiap kata tulus, setiap memori terjaga.</p>
        <div class="ily-text">Terima kasih. I love you ‚ù§Ô∏è</div>
      </div>
    `;

    const nav = document.createElement("div");
    nav.className = "navigasi";
    const kembaliBtn = document.createElement("button");
    kembaliBtn.textContent = "üè† Kembali ke Halaman Pertama";
    kembaliBtn.onclick = () => gantiHalaman("dashboardSurat");
    nav.appendChild(kembaliBtn);

    // Add gallery if available
    const list = window.preloadedGaleri || [];
    if (list.length) {
      const galeri = document.createElement("div");
      galeri.className = "photo-gallery";
      galeri.style.marginTop = "40px";
      
      list.forEach(src => {
        const photoItem = document.createElement("div");
        photoItem.className = "photo-item";
        
        const img = document.createElement("img");
        img.src = src;
        img.alt = "Kenangan";
        img.loading = "lazy";
        
        photoItem.appendChild(img);
        photoItem.onclick = () => {
          const lightbox = document.getElementById("lightbox");
          const lightboxImg = document.getElementById("lightboxImg");
          lightboxImg.src = src;
          lightbox.classList.add("active");
        };
        
        galeri.appendChild(photoItem);
      });
      
      div.appendChild(galeri);
    }

    div.appendChild(notif);
    div.appendChild(letterContent);
    div.appendChild(nav);
    container.appendChild(div);
  }

  // Shooting stars effect
  function createShootingStar() {
    const star = document.createElement("div");
    star.className = "shooting-star";
    star.style.left = Math.random() * 100 + "vw";
    star.style.animationDuration = (2 + Math.random() * 2) + "s";
    document.body.appendChild(star);
    setTimeout(() => star.remove(), 4000);
  }

  // Create background stars
  function createStars(jumlah = 200) {
    const starsContainer = document.querySelector(".stars");
    for (let i = 0; i < jumlah; i++) {
      const star = document.createElement("div");
      star.className = "star";
      star.style.top = `${Math.random() * 100}%`;
      star.style.left = `${Math.random() * 100}%`;
      star.style.animationDelay = `${Math.random() * 6}s`;
      star.style.animationDuration = `${3 + Math.random() * 4}s`;
      starsContainer.appendChild(star);
    }
  }

  // Initialize
  window.onload = () => {
    createStars();
    setInterval(() => {
      if (Math.random() < 0.3) createShootingStar();
    }, 3000);
  };
</script>
</html>
