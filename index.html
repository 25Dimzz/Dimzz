<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Memories - D | Semi-Transparent</title>
  <style>
    /* ===== BASE STYLES ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 20px;
      background: #0a0a0a;
      color: rgba(255, 255, 255, 0.95);
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    /* ===== STARS BACKGROUND ===== */
    .shooting-star {
      position: absolute;
      width: 3px;
      height: 3px;
      background: linear-gradient(90deg, transparent, #8A2BE2, transparent);
      border-radius: 50%;
      top: 0;
      left: 0;
      box-shadow:
        0 0 15px #8A2BE2,
        0 0 30px rgba(138, 43, 226, 0.5);
      animation: shoot 1.8s ease-out forwards;
      opacity: 0.9;
      z-index: 1;
    }

    @keyframes shoot {
      0% { transform: translate(0, 0) scale(1); opacity: 1; }
      100% { transform: translate(600px, 400px) scale(0); opacity: 0; }
    }

    .stars {
      position: fixed;
      width: 100%;
      height: 100%;
      background: transparent;
      z-index: -2;
      overflow: hidden;
    }

    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      box-shadow:
       0 0 6px rgba(138, 43, 226, 0.8),
       0 0 12px rgba(0, 206, 209, 0.6);
      animation: blink 4s infinite ease-in-out alternate;
    }

    @keyframes blink {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }

    /* ===== SEMI-TRANSPARANT CONTAINER ===== */
    .container {
      width: 90%;
      max-width: 820px;
      padding: 50px 40px;
      border-radius: 32px;
      
      /* SEMI-TRANSPARANT EFFECT */
      background: rgba(40, 40, 40, 0.7);
      
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 
        0 30px 80px rgba(0, 0, 0, 0.8),
        0 8px 16px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
      
      position: relative;
      text-align: center;
      z-index: 100;
      transition: all 0.4s ease;
      
      /* GLASS OVERLAY */
      overflow: hidden;
    }

    /* GRADIENT OVERLAY untuk efek glass */
    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0.05) 50%,
        rgba(255, 255, 255, 0.1) 100%
      );
      z-index: -1;
      pointer-events: none;
      border-radius: 32px;
    }

    .container:hover {
      background: rgba(45, 45, 45, 0.75);
      transform: translateY(-5px);
      box-shadow: 
        0 40px 100px rgba(0, 0, 0, 0.9),
        0 12px 24px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    /* ===== TYPOGRAPHY ===== */
    h1 {
      color: #ffffff;
      font-weight: 800;
      font-size: 3em;
      margin-bottom: 30px;
      letter-spacing: -0.5px;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    /* ===== MEDIA PLAYER ===== */
    .media-player {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 40px;
      background: rgba(50, 50, 50, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 24px;
      padding: 30px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .media-player::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.05) 0%,
        transparent 50%,
        rgba(255, 255, 255, 0.05) 100%
      );
      z-index: -1;
      pointer-events: none;
    }

    .media-player:hover {
      background: rgba(55, 55, 55, 0.75);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .media-player p {
      margin-bottom: 15px;
      color: rgba(255, 255, 255, 0.95);
      font-size: 1.3em;
      font-weight: 500;
    }

    .progress-container {
      width: 100%;
      max-width: 400px;
      height: 8px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      cursor: pointer;
      margin: 15px 0;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .progress {
      height: 100%;
      background: linear-gradient(90deg, #8A2BE2, #00CED1);
      width: 0%;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
      transition: width 0.1s linear;
    }

    .time {
      font-size: 0.95em;
      color: rgba(255, 255, 255, 0.8);
      margin-top: 8px;
      font-weight: 400;
    }

    /* ===== FORM ELEMENTS ===== */
    input[type="password"] {
      padding: 18px 24px;
      width: 250px;
      margin-bottom: 25px;
      border: none;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      font-size: 1.1em;
      font-family: -apple-system, sans-serif;
      text-align: center;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    input[type="password"]:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: #8A2BE2;
      box-shadow: 
        0 0 0 3px rgba(138, 43, 226, 0.2),
        inset 0 1px 3px rgba(0, 0, 0, 0.3);
      transform: scale(1.02);
    }

    /* ===== BUTTONS ===== */
    button {
      padding: 18px 36px;
      background: linear-gradient(135deg, #8A2BE2 0%, #00CED1 100%);
      border: none;
      border-radius: 18px;
      color: white;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 8px;
      font-family: -apple-system, sans-serif;
      position: relative;
      overflow: hidden;
      min-width: 160px;
      box-shadow: 
        0 10px 30px rgba(138, 43, 226, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    button:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 
        0 15px 40px rgba(138, 43, 226, 0.4),
        0 5px 20px rgba(0, 206, 209, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }

    button:active {
      transform: translateY(0) scale(0.98);
    }

    button::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.7s ease;
    }

    button:hover::after {
      left: 100%;
    }

    .navigasi {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 40px;
      flex-wrap: wrap;
    }

    /* ===== LAYERS/CARDS ===== */
    .layer {
      display: none;
      white-space: pre-wrap;
      word-wrap: break-word;
      animation: fadeIn 0.6s ease-in-out forwards;
      text-align: left;
      background: rgba(50, 50, 50, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 24px;
      padding: 35px;
      margin: 25px 0;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .layer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.05) 0%,
        transparent 50%,
        rgba(255, 255, 255, 0.05) 100%
      );
      z-index: -1;
      pointer-events: none;
      border-radius: 24px;
    }

    .layer:hover {
      background: rgba(55, 55, 55, 0.75);
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-3px);
      box-shadow: 
        0 25px 80px rgba(0, 0, 0, 0.7),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    .active {
      display: block;
    }

    .hidden {
      display: none;
    }

    /* ===== DASHBOARD ===== */
    .dashboard-text {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      margin: 0 auto 30px;
      max-width: 100%;
      padding: 0 20px;
      flex-direction: column;
      background: rgba(50, 50, 50, 0.7);
      border-radius: 24px;
      padding: 40px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 20px 60px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
    }

    .dashboard-text::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.08) 0%,
        transparent 50%,
        rgba(255, 255, 255, 0.08) 100%
      );
      z-index: -1;
      pointer-events: none;
    }

    .dashboard-text pre {
      font-size: 1.7em;
      line-height: 1.8;
      text-align: center;
      white-space: pre-wrap;
      color: rgba(255, 255, 255, 0.95);
      font-family: -apple-system, sans-serif;
    }

    .timestamper {
      font-size: 0.95em;
      color: rgba(255, 255, 255, 0.7);
      margin-top: 12px;
      text-align: right;
      font-style: italic;
      font-weight: 400;
    }

    .halaman-indikator {
      font-size: 0.95em;
      text-align: center;
      margin-top: 15px;
      color: rgba(255, 255, 255, 0.7);
      font-style: italic;
      font-weight: 400;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== PIGEON ANIMATION ===== */
    .pigeon-run {
      font-size: 3.5em;
      position: relative;
      display: block;
      animation: 
        pigeonLoop 10s ease-in-out infinite, 
        glowPulse 2.5s ease-in-out infinite,
        floatSubtle 3s ease-in-out infinite;
      opacity: 0.9;
      filter: drop-shadow(0 0 25px rgba(138, 43, 226, 0.8));
    }

    @keyframes pigeonLoop {
      0% { left: 100px; opacity: 0; transform: scale(0.95); }
      15% { opacity: 0.4; transform: scale(1); }
      50% { left: 0px; opacity: 1; transform: scale(1.05); }
      85% { opacity: 0.4; transform: scale(1); }
      100% { left: -100px; opacity: 0; transform: scale(0.95); }
    }

    @keyframes glowPulse {
      0%   { filter: drop-shadow(0 0 15px rgba(138, 43, 226, 0.7)); }
      50%  { filter: drop-shadow(0 0 30px rgba(138, 43, 226, 0.9)) drop-shadow(0 0 50px rgba(0, 206, 209, 0.6)); }
      100% { filter: drop-shadow(0 0 15px rgba(138, 43, 226, 0.7)); }
    }

    @keyframes floatSubtle {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }

    .fade-out {
      animation: fadeOut 2s ease forwards;
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    /* ===== NOTIFICATION ===== */
    .notif-penutup {
      text-align: center;
      font-size: 1.2em;
      color: rgba(255, 255, 255, 0.95);
      font-style: italic;
      margin-bottom: 30px;
      padding: 25px;
      background: rgba(138, 43, 226, 0.15);
      border-radius: 20px;
      border: 1px solid rgba(138, 43, 226, 0.3);
      box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.2),
        0 10px 40px rgba(138, 43, 226, 0.2);
    }

    .ily-text {
      display: block;
      margin-top: 10px;
      color: rgba(255, 255, 255, 0.8);
      font-size: 1.1em;
    }

    #counter {
      font-size: 1.4em;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.95);
      margin: 25px 0;
      padding: 20px;
      background: rgba(138, 43, 226, 0.15);
      border-radius: 18px;
      border: 1px solid rgba(138, 43, 226, 0.3);
      box-shadow: 
        0 15px 40px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    /* ===== GALLERY ===== */
    .galeri-mantan {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      grid-auto-flow: dense;
      gap: 15px;
      margin-top: 35px;
      padding: 25px;
      background: rgba(40, 40, 40, 0.7);
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 20px 60px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
    }

    .galeri-mantan::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.05) 0%,
        transparent 50%,
        rgba(255, 255, 255, 0.05) 100%
      );
      z-index: -1;
      pointer-events: none;
      border-radius: 24px;
    }

    .galeri-mantan img {
      width: 100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      border-radius: 18px;
      background-color: rgba(17, 17, 17, 0.8);
      box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      cursor: zoom-in;
      transition: all 0.4s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .galeri-mantan img:hover {
      transform: scale(1.05);
      box-shadow: 
        0 30px 70px rgba(0, 0, 0, 0.8),
        0 0 30px rgba(138, 43, 226, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      border-color: rgba(138, 43, 226, 0.4);
    }

    .galeri-mantan img.foto-besar {
      grid-column: span 2;
      aspect-ratio: 2 / 1;
    }

    /* ===== LIGHTBOX ===== */
    .lightbox {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.4s ease;
    }

    .lightbox.active {
        opacity: 1;
        pointer-events: auto;
    }

    .lightbox img {
        max-width: 90vw;
        max-height: 90vh;
        border-radius: 24px;
        transform: scale(0.85);
        opacity: 0;
        transition: transform 0.4s ease, opacity 0.4s ease;
        box-shadow: 0 50px 150px rgba(0, 0, 0, 1);
        border: 1px solid rgba(255, 255, 255, 0.15);
    }

    .lightbox.active img {
        transform: scale(1);
        opacity: 1;
    }

    /* ===== ASCII NOTIFICATION ===== */
    #asciiNotifAnime {
      display: none;
      white-space: pre-wrap;
      text-align: center;
      font-size: 1.5em;
      line-height: 1.8;
      background: rgba(40, 40, 40, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 20px;
      padding: 35px;
      margin: 30px auto;
      font-family: 'SF Mono', 'Monaco', monospace;
      color: rgba(255, 255, 255, 0.95);
      box-shadow: 
        0 25px 80px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    /* ===== ERROR MESSAGE ===== */
    #errorMsg {
      color: #ff6b6b;
      display: none;
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 107, 107, 0.15);
      border-radius: 14px;
      border: 1px solid rgba(255, 107, 107, 0.3);
      box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 10px 30px rgba(255, 107, 107, 0.1);
    }

    /* ===== FIXED NOTIFICATION ===== */
    .ios-notification {
      position: fixed !important;
      top: 80px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      background: rgba(30, 30, 30, 0.95) !important;
      color: white !important;
      padding: 16px 30px !important;
      border-radius: 20px !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.7) !important;
      z-index: 99999 !important;
      font-weight: 500 !important;
      font-size: 0.95em !important;
      animation: notificationSlideDown 0.3s ease forwards !important;
      display: flex !important;
      align-items: center !important;
      gap: 10px !important;
      white-space: nowrap !important;
      max-width: 90% !important;
      text-align: center !important;
      pointer-events: none !important;
    }

    @keyframes notificationSlideDown {
      from { 
        transform: translateX(-50%) translateY(-30px) !important; 
        opacity: 0 !important; 
      }
      to { 
        transform: translateX(-50%) translateY(0) !important; 
        opacity: 1 !important; 
      }
    }

    @keyframes notificationSlideUp {
      from { 
        transform: translateX(-50%) translateY(0) !important; 
        opacity: 1 !important; 
      }
      to { 
        transform: translateX(-50%) translateY(-30px) !important; 
        opacity: 0 !important; 
      }
    }

    /* ===== DYNAMIC ISLAND ===== */
    .dynamic-island {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 37px;
      background: rgba(35, 35, 35, 0.9);
      border-radius: 100px;
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.4s ease;
      box-shadow: 
        0 25px 80px rgba(0, 0, 0, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .dynamic-island:hover {
      width: 180px;
      background: rgba(40, 40, 40, 0.95);
    }

    .di-time {
      font-size: 0.9em;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.95);
    }

    .di-icons {
      display: flex;
      gap: 10px;
      font-size: 0.9em;
      color: rgba(255, 255, 255, 0.9);
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @media (max-width: 768px) {
      .container {
        padding: 30px 20px;
        width: 95%;
        border-radius: 28px;
      }
      
      h1 {
        font-size: 2.2em;
      }
      
      .media-player {
        padding: 20px;
      }
      
      button {
        padding: 16px 24px;
        min-width: 140px;
        font-size: 1em;
      }
      
      .layer, .dashboard-text {
        padding: 25px;
      }
      
      .galeri-mantan {
        grid-template-columns: repeat(2, 1fr);
        padding: 15px;
      }
      
      .pigeon-run {
        font-size: 2.5em;
      }
    }
   
    @media (max-width: 480px) {
      .galeri-mantan {
        grid-template-columns: 1fr;
      }
      
      .navigasi {
        flex-direction: column;
        align-items: center;
      }
      
      button {
        width: 100%;
        max-width: 250px;
      }
      
      input[type="password"] {
        width: 200px;
        padding: 15px 20px;
      }
    }
  </style>
  
  <!-- CryptoJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
  <!-- Dynamic Island -->
  <div class="dynamic-island">
    <div class="di-time" id="currentTime">12:30</div>
    <div class="di-icons">
      <span>üì∂</span>
      <span>üì°</span>
      <span>üîã</span>
    </div>
  </div>

  <!-- Main Container -->
  <div class="container">
    <h1>Memories - D</h1>

    <!-- üé∂ MUSIC PLAYER -->
    <div class="media-player">
      <p id="judulLagu" style="font-family: -apple-system, sans-serif; color: rgba(255, 255, 255, 0.95); font-size: 1.3em;">
        üéµ
      </p>
      <audio id="player" preload="auto" style="width:90%; max-width:500px; margin: 15px 0;"></audio>
      <div class="progress-container" onclick="setProgress(event)">
        <div class="progress" id="progressBar"></div>
      </div>
      <div class="time" id="timeDisplay">0:00 / 0:00</div>
      <div style="margin-top: 20px;">
        <button onclick="prevSong()">‚èÆ</button>
        <button onclick="togglePlay()">‚ñ∂Ô∏è / ‚è∏Ô∏è</button>
        <button onclick="nextSong()">‚è≠</button>
      </div>
    </div>

    <!-- LOGIN SECTION -->
    <div id="loginSection">
      <p style="font-size: 1.2em; color: rgba(255, 255, 255, 0.9); margin-bottom: 25px;">
        Masukkan kunci untuk membuka kenangan...
      </p>
      <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="off">
      <br><br>
      <button onclick="bukaSurat()">üîì Masuk</button>
      <p id="errorMsg">Salah. Coba lagi.</p>
    </div>

    <!-- LETTER SECTION -->
    <div id="suratSection" class="hidden">
      <p id="counter"></p>

      <!-- DASHBOARD -->
      <div class="layer active" id="dashboardSurat">
        <div class="dashboard-text">
          <div id="logoLoading" class="pigeon-run">üïäÔ∏è</div>
          <pre id="asciiNotifAnime"></pre>
        </div>
        <div class="navigasi">
          <button id="btnBukaSurat" onclick="bukaSuratAsli()" disabled>üìñ Buka Surat</button>
          <button id="btnNanti" onclick="showIOSNotification('Fitur nanti saja belum tersedia')" disabled>‚ùå Nanti Saja</button>
        </div>
      </div>

      <!-- ALL PAGES WILL BE INSERTED HERE -->
      <div id="semuaHalaman"></div>
    </div>
  </div>

  <!-- LIGHTBOX -->
  <div id="lightbox" class="lightbox" onclick="closeLightbox()">
    <img id="lightboxImg" src="" alt="Preview" />
  </div>

  <!-- STARS BACKGROUND -->
  <div class="stars"></div>

  <!-- JAVASCRIPT -->
  <script>
    // ===== CONFIGURATION =====
    const passwordHash = "f09b133c45f78e374cd650c77229de1a5ea54dc4d2d3ca9bb1ddfe3c496f7939";
    const encryptedSurat = {
        halaman1: "U2FsdGVkX1/5MLQVmF1+SCSSTHvdozyDT7IFTBsJU0BWz8+rcKXZ5aYUF17MjVrOA5jMdWOjFuM8dBcerxrzfxYtQbpdgd9oksanvD4YPZEegZI92kde+Fxlsvks9ngN24F6eC2A8e8hLLoMaRu/zXsbiPD1rjVTO7Fo0CejfH+eeoI7PDpfEoaFBcfYYhd3ylRm8mCsl8W5rqd5FOhiLpheWvx+yc7wAXqytajbwqSfQNDyUlMaNRpxtw82xoxm9eopod1RdRQIbdUgFSreJLR8RT0uikVrqzp5SAK5Sd+lfjoQVAp+h6nojy3+c/+D/tAEGNC0bGvgSNnqxOMUmW7nLimDBmABXrFgOj9GmRQ7q/7sVKzr24bBjS9s5cjGGJ/HxvCxsywyJ0CVxut5Vs/Adf8xm3/S7AXGCabyAooWZd5TO+v/hkx6GeaJaixMcQPM7Nu25ndWtbcBhVnVZqs8F2PSukUJL3lsrapzSB4PzdOQVZeKyhN5dA4xVlyvx0PrD7eDoAT+EYlkxR3qLvFFMfXF7r8CfgatxtN+iHE5NuYQ7tqarIQn4rlmU6qmxGDHtGyNvjU+sYS9A7Cmgd0deYOj486a1bBIVf+la5MVJqsbo9LiUxLmObxX62VuEKwIeZKqIOYyMWg+rHQuGWNrTwjTMw7mX/cWoX34GT4ZezbCuHbQm5t5Qu2jafWq468PtNTZFiuWqfyhcIDZzuPOiBcpTfFYMT5/JSojNXNYE9uJxyTMoFyF3xsZY7xq8GU9FAbDP8nmRg1MQ8EPznNZk7RwzMNXF4R3JAd9j9zoH+65JIxcSFwgOf73gOwhVXsvm5pnNiJ+cgK5t7sfs9XBgQset8xGy+CjzYh+csCCHhdO60gw1FaQqByzAlbKXZXBEqUR73MjbXK9lo26kjhuDxEDbeuYtVSv7wekiIh+51d8Gd1zQZ0HHOAtM2qwFTGWz5Wk8OxDH9iERDlZHWZ87iuD7XbEUJh3Uv1cRLM6Syki2sFOYCB94T+uUIBRizxpoY5+fh784uR065uZWBEo/44dmNf4nLBw/glEXR0BsfJ119UB70FVtNDQNA8vhMLuiHhbzXASO646Kcbf5IKGEabAOaj60Rp83TAGjMxGTRpfvPuLGs6O7skPctvwls1ZPIW/DDzroUIQuQQwI3vF91Mx2wFEoCtIcWDa+dPIN8NhTOim2WLVAVqCbt2EgAnllD1ZDEP1QskQYmntvkl8wsywuwGjyB/VmU0epLOLB7EoL41IqYGzSrMNEoIVafmgb8B85plt/Uwun1gp8qEiqShL1o08AZBQw+Pmq5ZIp4shZjYoUI3hPWAOQe5YXWUvbNHYBqF8+Cr4eBTub1cge7e4hEVb/auQ87B3W2CSWBpG0W0BZPlJtLM0aF7oMpMMCQelgLUYhHOSYpV4Fv9y6S9kZ",
        halaman2: "U2FsdGVkX18yo6X6jc6RlePplOt/mZJfT19F5q234eJgG3LGIrmm1qWj6r1P0jxhcYbPNafLghnLdYWcMwQmJGTueZ19G5XeYfXC8DSL10B2HdNIrpTyHoORbPorbn2fOz3gOtiqjOPuS53m6c1Yz5dMhJqjHidpka4c/4vqMOtS2BkA8Kiw0OkLqy0Ya1/OHlEUWKE365rkW4D0+NriEMpWum3AxMEtVGjZzxIzNQMtJ4kDqHsdPw+cgrB/6z+Fj9fibPGFFW11V/D+e07GeZ5yEZVS2yu0thRV/ErLiw0laUU1rmcbIZzZv+g/AJ3NuX7gBBUoEGHkH7yhUbHASmx2llldkjlvWg6Dpwt9NhDiRrGlQYNgB01mVN/jIt+TE64T3kMy4lTi2rHEgsWaKBhyUIyWCUWpMNGmxHt/j/oGajLmC4Ao+4U/3PnC4gy5jgQsOSrD6e0O9eur8WUtskNNrJfgw4EENnrtFZfTqpf5Mb/ZXBUh79SG3FtakMNpJdpGfpiQeBMnxdNhImU7pgzZw6zlojdqZCuI/UWeqKlQYkXFCz6jIGd12+7AY75qyLXTse0P9yPElEh4ovRlU1ftSYyc6FC5qzkVH9bLNoh2TJMshBCzSOkyP2cSW1EP3bEebJ6J021J91hJ1LXjPZyt+yJoljnTpMM2JOH+NN5wxVBrZR95+3cGZwBUO6XxDPllhmUjkfpvx48EOksKt/1BrFqZ9gsiNXlgWhm5k+ym/svjWby04NgX4oW4A5CIitKeDSA7mt+3S1dgWZCOuUpyDY4rs6cKm/kzmy9Qs5Iv+cS9MnLqVu1bnEFZOGDq3xDSpJ+wEDWrtjw48KguZ6JVVXW2ozJDqxsjedZwDslgbRC0emdSkjsJqZTbfBN9aMwgfX6XttinGbn//VvGQbjQIAkM8B++1hi9902HD6w+cCI1U3IwCJVBbzi2D0ognDBNhJhCKaYf0dCPm2YUM5NqwzCGdF2srhULqrqc/fZVnE83kxAyeezRcQYXB+ZDBQLqPhAMeVcGj70BmuLNoUaOZYGtSNO1G0Fm/IB7RmByp1FojVtSOSmajuS3Vmqj54xq7GJeULkuggsU+idaMY+cqABFTt6GE/m2pVazd+MBPv+KS/o/FaLsyq2NboCy4VWf5YD87r5SAGemkyDWnrUgI+hBjb1SHi53zPHDjfgUgDaaLtKHjNhMLRZxY2GR09kRZBqVM9a1zWBAYZ2dyvOswpyzqu88SyYqH/TpUAxCxdG/LcwQwO7CpSrglw+KV4jT0ZBDrRKnJLTAFbvBBFrR4EFoxziball6Xrp7+q5Il9ZAZjuA8GmkxklfxbPEipWQ7/9aHIc81+RFRHI1cTfDQ9ydJ4ziDS8y8ibVpJm1g0G6ZDntbjqr7TXlg+YFKc1cvriTESotvvDEzWRkN3VwoSRsUvuFK27kPVFARif5W8DgQYtlq0TFfK+8y0KPe88UooKHnJJsgBjPfJQ+ObboHuNRMAA/b1o12qhnSEBT4mh/cNG2i+ztbwvCYyk6orqMuMRYXWoKT/dRLLmab5kw8RxOnijXvEjZY9DbXTnuWl/AMU/nKM/i8pJrzfUXGiBCjMAqcRhubckB61eJBEuZhwaW6qzCjlEhIKrelmlCAIBv2jEcA/KiQjKN4M7Mz528eeoT8kVRmQhFiw750G0Du9tkmPeV7EchgI4FOPBJ4aaiu939OPQSgqy1DDCl",
        halaman3: "YxvZ/MNLp7Zwy++ePlpmguVl0+eP6vkVdt5FyAXdlCM2gHCJe60J9hezkJ2enrOOU2vt3nWdmjEJO8juau5apV48ztnQBRQKkU/UgTY5s4uwmx9FECiHUIpRVAVDl+gf4Kg/533Ey/mEmRjhV2+DEYqDeIEXmnHOhvGz4m",
        suratTerakhir: "U2FsdGVkX18kScDn3Q/XZxlN/bY2U8aSQQMakJxdoIgak05Ecknjubfw32RENGXLYgkIvws/ct07apmhsPzjYJwdaNakQIeYDuNFngTUWr15R6NemjBagOw2Bbe+tUA63/E5mKM8repofTsBeXd0UbE0QXg4bprGIDnfSszmOi/bdS03G1eAjaazDN8kRYd0dKBFtenYPp6PWI7jmlU0fdHXlxlQ+F/Y0ZFDw1h4/ZqrT6IziMf8egdQPTXsSHk95n0qitNvsM85C4fjQPkX4hP1vw9gtczzVjf1bJqc3bCQZ8nMxuhe0FSeJyZGrzNS/ea77Lw8xKfzE1sEpe9+PycbtdZ+P4eBn8f1KspDCYpp4Y1lU1e+5sDuRStBVbWbiB2Jetv7mdnVc5elapKaW8RASBHoW4bo4na8Bu2WJlLEtLMFkBBDmOlSU5RVDDo1nszon6LHFoD0AkHWPGRRJw==",
    };

    // ===== MUSIC PLAYER =====
    const laguList = [
      { judul: "New x Ruin My Life (Slowed)", file: "X.mp3" },
      { judul: "Cardigan - Taylor Swift", file: "cardigan.mp3" },
      { judul: "Message in a Bottle - Taylor Swift", file: "message-in-a-bottle.mp3" },
      { judul: "All Too Well - Taylor Swift", file: "all-too-well.mp3" },
      { judul: "Your Are In Love - Taylor Swift", file: "your-are-in-love.mp3" },
      { judul: "Cry - Cigarettes After Sex", file: "cry.mp3" },   
      { judul: "Apocalypse - Cigarettes After Sex", file: "apocalypse.mp3" },   
    ];

    let index = 0;
    let player, judulLagu, progressBar, timeDisplay;
    let currentNotification = null;

    // ===== INITIALIZATION =====
    document.addEventListener("DOMContentLoaded", () => {
        player = document.getElementById("player");
        judulLagu = document.getElementById("judulLagu");
        progressBar = document.getElementById("progressBar");
        timeDisplay = document.getElementById("timeDisplay");

        if (player) {
            player.addEventListener("timeupdate", updateProgress);
            player.addEventListener("loadedmetadata", updateProgress);
            player.addEventListener("ended", nextSong);
            loadLagu();
        }

        updateDynamicIslandTime();
        setInterval(updateDynamicIslandTime, 60000);

        createStars();
        
        setInterval(() => {
            if (Math.random() < 0.4) createShootingStar();
        }, 4500);
        
        setTimeout(() => {
            showIOSNotification('Memories - D ‚Ä¢ Semi-Transparent');
        }, 1500);
    });

    // ===== MUSIC FUNCTIONS =====
    function loadLagu() {
        if (!player || !laguList.length) return;
        player.src = laguList[index].file;
        judulLagu.textContent = "üéµ " + laguList[index].judul;
    }

    function togglePlay() {
        if (!player) return;
        if (player.paused) {
            player.play().catch(() => {});
            showIOSNotification("Now playing: " + laguList[index].judul);
        } else {
            player.pause();
            showIOSNotification("Music paused");
        }
    }

    function nextSong() {
        if (!player) return;
        index = (index + 1) % laguList.length;
        loadLagu();
        player.play();
        showIOSNotification("‚ñ∂Ô∏è " + laguList[index].judul);
    }

    function prevSong() {
        if (!player) return;
        index = (index - 1 + laguList.length) % laguList.length;
        loadLagu();
        player.play();
        showIOSNotification("‚èÆ " + laguList[index].judul);
    }

    function updateProgress() {
        if (!player || !progressBar || !timeDisplay) return;
        const current = player.currentTime;
        const duration = player.duration || 0;
        const percent = (current / duration) * 100;
        progressBar.style.width = percent + "%";

        const format = t => {
            if (isNaN(t)) return "0:00";
            const m = Math.floor(t / 60);
            const s = Math.floor(t % 60);
            return `${m}:${s < 10 ? "0" + s : s}`;
        };
        timeDisplay.textContent = `${format(current)} / ${format(duration)}`;
    }

    function setProgress(e) {
        if (!player) return;
        const rect = e.currentTarget.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const width = rect.width;
        const percent = clickX / width;
        player.currentTime = player.duration * percent;
    }

    // ===== PASSWORD & LETTER SYSTEM =====
    let passwordYangBenar = "";

    async function bukaSurat() {
        const pass = document.getElementById("password").value;
        const encoder = new TextEncoder();
        const data = encoder.encode(pass);
        const hashBuffer = await crypto.subtle.digest("SHA-256", data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join("");

        if (hashHex === passwordHash) {
            passwordYangBenar = pass;
            document.getElementById("loginSection").classList.add("hidden");
            document.getElementById("suratSection").classList.remove("hidden");
            playMusik();
            hitungHari();
            gantiHalaman("dashboardSurat");

            document.querySelector(".container").style.transform = "scale(1.02)";
            setTimeout(() => {
                document.querySelector(".container").style.transform = "";
            }, 300);

            setTimeout(() => {
                showAsciiAnime();
                document.getElementById("btnBukaSurat").disabled = false;
                document.getElementById("btnNanti").disabled = false;
            }, 2000);

            renderHalaman(pass);
            
            fetch("foto.json")
                .then(res => res.json())
                .then(encrypted => {
                    window.preloadedGaleri = encrypted.map(e =>
                        CryptoJS.AES.decrypt(e, pass).toString(CryptoJS.enc.Utf8)
                    );
                });
            
            showIOSNotification("üîì Memories unlocked successfully");
        } else {
            document.getElementById("errorMsg").style.display = "block";
            document.getElementById("password").style.borderColor = "#ff6b6b";
            showIOSNotification("‚ùå Incorrect password");
        }
    }

    function showAsciiAnime() {
        const notif = document.getElementById("asciiNotifAnime");
        const asciiText = `
üìú Hi, seseorang yang selalu aku tunggu untuk baco surat ini...
tolong di baco sampe habis yoo, karno surat ini aku bikin penuh dengan kenangan hehe...
kalo kau cape baco nyo baco pelan" bae perhalaman dpp kok hehe...

üñ§ Surat ini diem-diem dijaga sejak hari pertama...
dan cuma buat kamu.
- D
        `;

        notif.style.display = "block";
        notif.textContent = "";
        let i = 0;
        function typingAnime() {
            if (i < asciiText.length) {
                notif.textContent += asciiText.charAt(i);
                i++;
                setTimeout(typingAnime, 45);
            }
        }
        typingAnime();
    }

    function gantiHalaman(n) {
        document.querySelectorAll(".layer").forEach(el => el.classList.remove("active"));
        const target = typeof n === 'string' ? document.getElementById(n) : document.getElementById("halaman" + n);
        if (target) {
            target.classList.add("active");
            target.style.animation = "fadeIn 0.6s ease-in-out";
        }
    }

    function bukaSuratAsli() {
        gantiHalaman(1);
        showIOSNotification("üìñ Opening letter...");
    }

    function hitungHari() {
        const awal = new Date("2025-06-24T00:30:00");
        const sekarang = new Date();
        const selisih = Math.floor((sekarang - awal) / (1000 * 60 * 60 * 24));
        document.getElementById("counter").textContent = `üìÖ Surat ini sudah disimpan selama ${selisih} hari.`;
    }

    function renderHalaman(kunci) {
        const container = document.getElementById("semuaHalaman");
        for (let i = 1; i <= 10; i++) {
            const key = "halaman" + i;
            if (!encryptedSurat[key]) continue;

            const div = document.createElement("div");
            div.classList.add("layer");
            div.id = key;

            const decrypted = CryptoJS.AES.decrypt(encryptedSurat[key], kunci).toString(CryptoJS.enc.Utf8);
            const p = document.createElement("p");
            p.textContent = decrypted;
            p.style.fontSize = "1.1em";
            p.style.lineHeight = "1.8";
            p.style.color = "rgba(255, 255, 255, 0.9)";

            const timestamp = document.createElement("div");
            timestamp.className = "timestamper";
            timestamp.textContent = `üìÖ Dibuka pada ${new Date().toLocaleString("id-ID")}`;

            const indikator = document.createElement("div");
            indikator.className = "halaman-indikator";
            indikator.textContent = `üìñ Halaman ${i} - 10`;

            const nav = document.createElement("div");
            nav.className = "navigasi";

            if (i > 1) {
                const back = document.createElement("button");
                back.textContent = "‚¨Ö Kembali";
                back.onclick = () => gantiHalaman(i - 1);
                nav.appendChild(back);
            }

            if (i < 10 && encryptedSurat["halaman" + (i + 1)]) {
                const next = document.createElement("button");
                next.textContent = "Lanjut ‚û°";
                next.onclick = () => gantiHalaman(i + 1);
                nav.appendChild(next);
            } else {
                const toLast = document.createElement("button");
                toLast.textContent = "üìú Surat Terakhir";
                toLast.onclick = () => bukaSuratTerakhir(kunci);
                nav.appendChild(toLast);
            }

            div.appendChild(p);
            div.appendChild(timestamp);
            div.appendChild(indikator);
            div.appendChild(nav);
            container.appendChild(div);
        }
    }

    function bukaSuratTerakhir(kunci) {
        const container = document.getElementById("semuaHalaman");
        container.querySelectorAll(".layer").forEach(el => el.remove());

        const div = document.createElement("div");
        div.classList.add("layer", "active");
        div.id = "suratTerakhirLayer";

        const decrypted = CryptoJS.AES.decrypt(encryptedSurat.suratTerakhir, kunci).toString(CryptoJS.enc.Utf8);
        const p = document.createElement("p");
        p.textContent = decrypted;
        p.style.fontSize = "1.1em";
        p.style.lineHeight = "1.8";
        p.style.color = "rgba(255, 255, 255, 0.9)";

        const timestamp = document.createElement("div");
        timestamp.className = "timestamper";
        timestamp.textContent = `üìÖ Dibuka pada ${new Date().toLocaleString("id-ID")}`;

        const notif = document.createElement("div");
        notif.className = "notif-penutup";
        notif.innerHTML = `üì© Surat ini telah dibaca sampai akhir.<br><span class="ily-text">Terima kasih. ily<3</span>`;

        const nav = document.createElement("div");
        nav.className = "navigasi";
        const kembaliBtn = document.createElement("button");
        kembaliBtn.textContent = "üè† Kembali ke Dashboard";
        kembaliBtn.onclick = () => {
            const dashboard = document.getElementById("dashboardSurat");
            dashboard.classList.add("fade-out");
            setTimeout(() => {
                gantiHalaman("dashboardSurat");
                dashboard.classList.remove("fade-out");
            }, 750);
        };
        nav.appendChild(kembaliBtn);

        div.appendChild(notif);
        div.appendChild(p);
        div.appendChild(timestamp);
        div.appendChild(nav);

        const list = window.preloadedGaleri || [];
        if (list.length > 0) {
            const galeri = document.createElement("div");
            galeri.className = "galeri-mantan";

            list.forEach((src, idx) => {
                const img = document.createElement("img");
                img.src = src;
                img.loading = "lazy";
                img.alt = `Memory ${idx + 1}`;
                
                if (Math.random() > 0.7) {
                    img.classList.add("foto-besar");
                }

                img.onclick = () => {
                    const lightbox = document.getElementById("lightbox");
                    const lightboxImg = document.getElementById("lightboxImg");

                    lightboxImg.src = src;
                    lightboxImg.style.opacity = "0";
                    lightboxImg.style.transform = "scale(1.2)";
                    lightbox.classList.add("active");

                    setTimeout(() => {
                        lightboxImg.style.opacity = "1";
                        lightboxImg.style.transform = "scale(1)";
                    }, 20);
                };

                galeri.appendChild(img);
            });

            div.appendChild(galeri);
        }

        container.appendChild(div);
        showIOSNotification("üìú Last page reached");
    }

    // ===== UTILITY FUNCTIONS =====
    function playMusik() {
        if (player) player.play().catch(() => {});
    }

    function pauseMusik() {
        if (player) player.pause();
    }

    // ===== VISUAL EFFECTS =====
    function createShootingStar() {
        const star = document.createElement("div");
        star.className = "shooting-star";
        star.style.top = Math.random() * window.innerHeight * 0.4 + "px";
        star.style.left = Math.random() * window.innerWidth * 0.2 + "px";
        document.body.appendChild(star);
        setTimeout(() => star.remove(), 1800);
    }

    function createStars(jumlah = 150) {
        const starsContainer = document.querySelector(".stars");
        for (let i = 0; i < jumlah; i++) {
            const star = document.createElement("div");
            star.className = "star";
            star.style.top = `${Math.random() * 100}%`;
            star.style.left = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 4}s`;
            starsContainer.appendChild(star);
        }
    }

    // ===== NOTIFICATION SYSTEM =====
    function showIOSNotification(message) {
        if (currentNotification) {
            currentNotification.style.animation = "notificationSlideUp 0.3s ease forwards";
            setTimeout(() => {
                if (currentNotification && currentNotification.parentNode) {
                    currentNotification.parentNode.removeChild(currentNotification);
                }
            }, 300);
        }
        
        const notif = document.createElement("div");
        notif.className = "ios-notification";
        notif.innerHTML = `üì± ${message}`;
        document.body.appendChild(notif);
        
        currentNotification = notif;
        
        setTimeout(() => {
            if (notif.parentNode) {
                notif.style.animation = "notificationSlideUp 0.3s ease forwards";
                setTimeout(() => {
                    if (notif.parentNode) {
                        notif.parentNode.removeChild(notif);
                    }
                    if (currentNotification === notif) {
                        currentNotification = null;
                    }
                }, 300);
            }
        }, 3000);
    }

    // ===== DYNAMIC ISLAND TIME =====
    function updateDynamicIslandTime() {
        const now = new Date();
        const timeStr = now.getHours().toString().padStart(2, '0') + ':' + 
                       now.getMinutes().toString().padStart(2, '0');
        document.getElementById('currentTime').textContent = timeStr;
    }

    // ===== LIGHTBOX CLOSE FUNCTION =====
    function closeLightbox() {
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightboxImg');
        
        lightboxImg.style.opacity = "0";
        lightboxImg.style.transform = "scale(0.9)";
        
        setTimeout(() => {
            lightbox.classList.remove("active");
            lightboxImg.style.opacity = "";
            lightboxImg.style.transform = "";
        }, 200);
    }

    // ===== ENHANCED INTERACTIONS =====
    document.addEventListener('DOMContentLoaded', function() {
        const buttons = document.querySelectorAll('button');
        buttons.forEach(btn => {
            btn.addEventListener('mousedown', function() {
                this.style.transform = 'scale(0.96)';
            });
            btn.addEventListener('mouseup', function() {
                this.style.transform = '';
            });
            btn.addEventListener('mouseleave', function() {
                this.style.transform = '';
            });
        });

        const passwordInput = document.getElementById('password');
        if (passwordInput) {
            passwordInput.addEventListener('focus', function() {
                this.style.transform = 'scale(1.02)';
            });
            passwordInput.addEventListener('blur', function() {
                this.style.transform = '';
            });
        }
    });

    // ===== KEYBOARD SHORTCUTS =====
    document.addEventListener('keydown', function(e) {
        if (e.code === 'Space' && !e.target.matches('input, textarea')) {
            e.preventDefault();
            togglePlay();
        }
        if (e.code === 'Escape') {
            closeLightbox();
        }
        if (e.code === 'Enter' && document.activeElement === document.getElementById('password')) {
            bukaSurat();
        }
    });
  </script>
</body>
</html>
